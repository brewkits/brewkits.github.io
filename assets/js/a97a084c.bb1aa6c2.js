"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[238],{4073(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"kmp/publishing","title":"Publishing KMP Libraries","description":"A comprehensive guide to publishing your Kotlin Multiplatform library.","source":"@site/docs/kmp/publishing.md","sourceDirName":"kmp","slug":"/kmp/publishing","permalink":"/docs/kmp/publishing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started with Kotlin Multiplatform","permalink":"/docs/kmp/getting-started"},"next":{"title":"KMP Best Practices","permalink":"/docs/kmp/best-practices"}}');var l=i(4848),r=i(8453);const t={sidebar_position:2},a="Publishing KMP Libraries",o={},c=[{value:"Publishing Destinations",id:"publishing-destinations",level:2},{value:"Pre-Publishing Checklist",id:"pre-publishing-checklist",level:2},{value:"1. Complete Metadata",id:"1-complete-metadata",level:3},{value:"2. Configure Publishing",id:"2-configure-publishing",level:3},{value:"3. Sign Your Artifacts",id:"3-sign-your-artifacts",level:3},{value:"Publishing to Maven Central",id:"publishing-to-maven-central",level:2},{value:"1. Create Sonatype Account",id:"1-create-sonatype-account",level:3},{value:"2. Configure Credentials",id:"2-configure-credentials",level:3},{value:"3. Publish",id:"3-publish",level:3},{value:"4. Release",id:"4-release",level:3},{value:"Publishing to GitHub Packages",id:"publishing-to-github-packages",level:2},{value:"1. Configure Repository",id:"1-configure-repository",level:3},{value:"2. Set Credentials",id:"2-set-credentials",level:3},{value:"3. Publish",id:"3-publish-1",level:3},{value:"Publishing to klibs.io",id:"publishing-to-klibsio",level:2},{value:"1. Create Account",id:"1-create-account",level:3},{value:"2. Generate API Token",id:"2-generate-api-token",level:3},{value:"3. Configure Plugin",id:"3-configure-plugin",level:3},{value:"4. Publish",id:"4-publish",level:3},{value:"Versioning",id:"versioning",level:2},{value:"Documentation",id:"documentation",level:2},{value:"1. README.md",id:"1-readmemd",level:3},{value:"Gradle (Groovy)",id:"gradle-groovy",level:3},{value:"Usage",id:"usage",level:2},{value:"Supported Platforms",id:"supported-platforms",level:2},{value:"License",id:"license",level:2},{value:"CI/CD with GitHub Actions",id:"cicd-with-github-actions",level:2},{value:".github/workflows/publish.yml",id:"githubworkflowspublishyml",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Changelog",id:"1-changelog",level:3},{value:"2. Git Tags",id:"2-git-tags",level:3},{value:"3. Release Notes",id:"3-release-notes",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"publishing-kmp-libraries",children:"Publishing KMP Libraries"})}),"\n",(0,l.jsx)(n.p,{children:"A comprehensive guide to publishing your Kotlin Multiplatform library."}),"\n",(0,l.jsx)(n.h2,{id:"publishing-destinations",children:"Publishing Destinations"}),"\n",(0,l.jsx)(n.p,{children:"You can publish KMP libraries to:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Maven Central"})," - The primary repository for JVM/Android libraries"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"klibs.io"})," - Kotlin-specific library repository"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"GitHub Packages"})," - Private or organization-specific packages"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Custom Maven Repository"})," - Self-hosted solutions"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"pre-publishing-checklist",children:"Pre-Publishing Checklist"}),"\n",(0,l.jsx)(n.h3,{id:"1-complete-metadata",children:"1. Complete Metadata"}),"\n",(0,l.jsxs)(n.p,{children:["Configure your ",(0,l.jsx)(n.code,{children:"build.gradle.kts"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'plugins {\n    kotlin("multiplatform") version "1.9.20"\n    id("com.android.library")\n    id("maven-publish")\n    id("signing")\n}\n\ngroup = "dev.brewkits"\nversion = "1.0.0"\n\nkotlin {\n    android {\n        publishLibraryVariants("release")\n    }\n    ios()\n    jvm()\n    js(IR) {\n        browser()\n        nodejs()\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-configure-publishing",children:"2. Configure Publishing"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'publishing {\n    publications {\n        publications.withType<MavenPublication> {\n            pom {\n                name.set("My KMP Library")\n                description.set("A fantastic Kotlin Multiplatform library")\n                url.set("https://brewkits.dev/my-kmp-library")\n\n                licenses {\n                    license {\n                        name.set("The Apache License, Version 2.0")\n                        url.set("http://www.apache.org/licenses/LICENSE-2.0.txt")\n                    }\n                }\n\n                developers {\n                    developer {\n                        id.set("brewkits")\n                        name.set("BrewKits Team")\n                        email.set("team@brewkits.dev")\n                    }\n                }\n\n                scm {\n                    connection.set("scm:git:git://github.com/brewkits/my-kmp-library.git")\n                    developerConnection.set("scm:git:ssh://github.com/brewkits/my-kmp-library.git")\n                    url.set("https://github.com/brewkits/my-kmp-library")\n                }\n            }\n        }\n    }\n\n    repositories {\n        maven {\n            name = "GitHubPackages"\n            url = uri("https://maven.pkg.github.com/brewkits/my-kmp-library")\n            credentials {\n                username = project.findProperty("gpr.user") as String? ?: System.getenv("GITHUB_ACTOR")\n                password = project.findProperty("gpr.token") as String? ?: System.getenv("GITHUB_TOKEN")\n            }\n        }\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-sign-your-artifacts",children:"3. Sign Your Artifacts"}),"\n",(0,l.jsx)(n.p,{children:"For Maven Central, signing is required:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:"signing {\n    useGpgCmd()\n    sign(publishing.publications)\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"Configure GPG:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Generate key\ngpg --gen-key\n\n# List keys\ngpg --list-keys\n\n# Export public key\ngpg --keyserver keyserver.ubuntu.com --send-keys YOUR_KEY_ID\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Add to ",(0,l.jsx)(n.code,{children:"~/.gradle/gradle.properties"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"signing.gnupg.executable=gpg\nsigning.gnupg.keyName=YOUR_KEY_ID\n"})}),"\n",(0,l.jsx)(n.h2,{id:"publishing-to-maven-central",children:"Publishing to Maven Central"}),"\n",(0,l.jsx)(n.h3,{id:"1-create-sonatype-account",children:"1. Create Sonatype Account"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Visit ",(0,l.jsx)(n.a,{href:"https://issues.sonatype.org/",children:"Sonatype OSSRH"})]}),"\n",(0,l.jsx)(n.li,{children:"Create an account"}),"\n",(0,l.jsx)(n.li,{children:"Create a new project ticket"}),"\n",(0,l.jsx)(n.li,{children:"Verify domain ownership"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-configure-credentials",children:"2. Configure Credentials"}),"\n",(0,l.jsxs)(n.p,{children:["Add to ",(0,l.jsx)(n.code,{children:"~/.gradle/gradle.properties"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"sonatypeUsername=your_username\nsonatypePassword=your_password\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-publish",children:"3. Publish"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./gradlew publishAllPublicationsToMavenCentralRepository\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-release",children:"4. Release"}),"\n",(0,l.jsx)(n.p,{children:"After publishing to staging:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Close and release\n./gradlew closeAndReleaseRepository\n"})}),"\n",(0,l.jsx)(n.h2,{id:"publishing-to-github-packages",children:"Publishing to GitHub Packages"}),"\n",(0,l.jsx)(n.h3,{id:"1-configure-repository",children:"1. Configure Repository"}),"\n",(0,l.jsx)(n.p,{children:"Already shown in the publishing configuration above."}),"\n",(0,l.jsx)(n.h3,{id:"2-set-credentials",children:"2. Set Credentials"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"export GITHUB_ACTOR=your_github_username\nexport GITHUB_TOKEN=your_personal_access_token\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Or add to ",(0,l.jsx)(n.code,{children:"~/.gradle/gradle.properties"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"gpr.user=your_github_username\ngpr.token=your_personal_access_token\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-publish-1",children:"3. Publish"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./gradlew publishAllPublicationsToGitHubPackagesRepository\n"})}),"\n",(0,l.jsx)(n.h2,{id:"publishing-to-klibsio",children:"Publishing to klibs.io"}),"\n",(0,l.jsx)(n.h3,{id:"1-create-account",children:"1. Create Account"}),"\n",(0,l.jsxs)(n.p,{children:["Visit ",(0,l.jsx)(n.a,{href:"https://klibs.io",children:"klibs.io"})," and create an account."]}),"\n",(0,l.jsx)(n.h3,{id:"2-generate-api-token",children:"2. Generate API Token"}),"\n",(0,l.jsx)(n.p,{children:"In your klibs.io dashboard:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Go to Settings \u2192 API Tokens"}),"\n",(0,l.jsx)(n.li,{children:"Generate a new token"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-configure-plugin",children:"3. Configure Plugin"}),"\n",(0,l.jsxs)(n.p,{children:["Add to ",(0,l.jsx)(n.code,{children:"build.gradle.kts"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'plugins {\n    id("io.klibs.publish") version "1.0.0"\n}\n\nklibs {\n    apiToken.set(System.getenv("KLIBS_API_TOKEN"))\n\n    library {\n        name.set("my-kmp-library")\n        description.set("A fantastic KMP library")\n        tags.set(listOf("kotlin", "multiplatform", "mobile"))\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-publish",children:"4. Publish"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"export KLIBS_API_TOKEN=your_api_token\n./gradlew publishToKlibs\n"})}),"\n",(0,l.jsx)(n.h2,{id:"versioning",children:"Versioning"}),"\n",(0,l.jsxs)(n.p,{children:["Follow ",(0,l.jsx)(n.a,{href:"https://semver.org/",children:"Semantic Versioning"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'// build.gradle.kts\nversion = "1.0.0"  // Initial release\nversion = "1.0.1"  // Bug fix\nversion = "1.1.0"  // New feature\nversion = "2.0.0"  // Breaking change\n'})}),"\n",(0,l.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,l.jsx)(n.h3,{id:"1-readmemd",children:"1. README.md"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:'# My KMP Library\n\n## Installation\n\n### Gradle (Kotlin DSL)\n\n```kotlin\ndependencies {\n    implementation("dev.brewkits:my-kmp-library:1.0.0")\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"gradle-groovy",children:"Gradle (Groovy)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-groovy",children:"dependencies {\n    implementation 'dev.brewkits:my-kmp-library:1.0.0'\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:"val greeting = Greeting()\nprintln(greeting.greet())\n"})}),"\n",(0,l.jsx)(n.h2,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Android"}),"\n",(0,l.jsx)(n.li,{children:"iOS"}),"\n",(0,l.jsx)(n.li,{children:"JVM"}),"\n",(0,l.jsx)(n.li,{children:"JavaScript"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,l.jsx)(n.p,{children:"Apache 2.0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\n### 2. API Documentation\n\nGenerate KDoc:\n\n```bash\n./gradlew dokkaHtml\n"})}),"\n",(0,l.jsx)(n.p,{children:"Host on GitHub Pages:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Deploy docs\n./gradlew dokkaHtml\ncp -r build/dokka/html/* docs/\ngit add docs/\ngit commit -m "Update documentation"\ngit push\n'})}),"\n",(0,l.jsx)(n.h2,{id:"cicd-with-github-actions",children:"CI/CD with GitHub Actions"}),"\n",(0,l.jsx)(n.h3,{id:"githubworkflowspublishyml",children:".github/workflows/publish.yml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Publish\n\non:\n  release:\n    types: [created]\n\njobs:\n  publish:\n    runs-on: macos-latest\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Set up JDK\n        uses: actions/setup-java@v3\n        with:\n          java-version: 17\n          distribution: 'temurin'\n\n      - name: Publish to Maven Central\n        env:\n          SONATYPE_USERNAME: ${{ secrets.SONATYPE_USERNAME }}\n          SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n          SIGNING_KEY: ${{ secrets.SIGNING_KEY }}\n          SIGNING_PASSWORD: ${{ secrets.SIGNING_PASSWORD }}\n        run: |\n          ./gradlew publishAllPublicationsToMavenCentralRepository\n          ./gradlew closeAndReleaseRepository\n\n      - name: Publish to GitHub Packages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n        run: ./gradlew publishAllPublicationsToGitHubPackagesRepository\n"})}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"1-changelog",children:"1. Changelog"}),"\n",(0,l.jsxs)(n.p,{children:["Maintain ",(0,l.jsx)(n.code,{children:"CHANGELOG.md"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"# Changelog\n\n## [1.0.1] - 2024-01-15\n\n### Fixed\n- Fixed crash on iOS when...\n\n### Changed\n- Improved performance of...\n\n## [1.0.0] - 2024-01-01\n\n### Added\n- Initial release\n- Support for Android, iOS, JVM\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-git-tags",children:"2. Git Tags"}),"\n",(0,l.jsx)(n.p,{children:"Tag releases:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'git tag -a v1.0.0 -m "Release 1.0.0"\ngit push origin v1.0.0\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-release-notes",children:"3. Release Notes"}),"\n",(0,l.jsx)(n.p,{children:"Create GitHub releases with:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Version number"}),"\n",(0,l.jsx)(n.li,{children:"Changelog excerpt"}),"\n",(0,l.jsx)(n.li,{children:"Breaking changes (if any)"}),"\n",(0,l.jsx)(n.li,{children:"Migration guide (for major versions)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Issue"}),': Publishing fails with "Unauthorized"']}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Check your credentials in gradle.properties\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Issue"}),": Signing fails"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Verify GPG key is properly configured\ngpg --list-secret-keys\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Issue"}),": iOS framework not built"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Publishing must be done on macOS with Xcode installed\n"})}),"\n",(0,l.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://central.sonatype.org/publish/publish-guide/",children:"Maven Central Guide"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://kotlinlang.org/docs/multiplatform-publish-lib.html",children:"Kotlin Multiplatform Publishing"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.github.com/en/packages",children:"GitHub Packages Documentation"})}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:"Share your libraries with the world!"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>t,x:()=>a});var s=i(6540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);